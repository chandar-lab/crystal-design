[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
  0%|                                                                                 | 0/200000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/network/scratch/p/prashant.govindarajan/crystal_design_project/crystal-design/crystal_design/runner/crystal_cql.py", line 643, in <module>
    config = train()
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/pyrallis/argparsing.py", line 158, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
  File "/network/scratch/p/prashant.govindarajan/crystal_design_project/crystal-design/crystal_design/runner/crystal_cql.py", line 497, in train
    log_dict = trainer.train(batch)
  File "/network/scratch/p/prashant.govindarajan/crystal_design_project/crystal-design/crystal_design/runner/crystal_cql.py", line 368, in train
    qf_loss, pred_actions = self._q_loss(
  File "/network/scratch/p/prashant.govindarajan/crystal_design_project/crystal-design/crystal_design/runner/crystal_cql.py", line 227, in _q_loss
    q1_all = self.qnet(observations,observations.edata['e_feat'], observations.ndata['atomic_number'], observations.lengths_angles_focus)
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/network/scratch/p/prashant.govindarajan/crystal_design_project/crystal-design/crystal_design/agents/agents.py", line 176, in forward
    node_feat, edge_feat, focus_feat = self.embedding(node_feat, edge_feat, focus_feat)
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/network/scratch/p/prashant.govindarajan/crystal_design_project/matgl/src/matgl/layers/_embedding.py", line 69, in forward
    node_feat = self.layer_node_embedding(node_attr)
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/mila/p/prashant.govindarajan/.conda/envs/csd/lib/python3.10/site-packages/torch/nn/functional.py", line 2233, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)